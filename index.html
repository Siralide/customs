<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TPV - Grove Customs</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      background-color: #1c1f24;
      color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .card-custom {
      background-color: #2c3036;
      border: none;
      border-radius: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .form-control, .form-check-input {
      background-color: #343a40;
      border: 1px solid #495057;
      color: #f8f9fa;
    }
    .form-control::placeholder {
      color: #adb5bd;
    }
    .form-check-label {
      margin-left: 0.5rem;
    }
    .seccion {
      margin-bottom: 2rem;
    }
    .ticket {
      background: #2c3036;
      padding: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 1rem;
    }
    .ticket-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }
    .reset-btn {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1 mx-auto fs-2">Grove Customs - TPV</span>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <!-- Instrucciones -->
      <div class="col-md-3">
        <div class="card-custom">
          <h5>Instrucciones</h5>
          <ul>
            <li>Introduce el precio base del vehículo.</li>
            <li>El porcentaje base por defecto es 20%.</li>
            <li>Selecciona si se aplican Reparación (45$), Pintura o Modificaciones.</li>
            <li>Pintura cuesta 30% del porcentaje base, excepto si hay modificaciones, donde cuesta solo 5%.</li>
            <li>Si se aplica "Convenio", se descuenta un porcentaje (por defecto 10%).</li>
            <li>Presiona reset para comenzar con un nuevo cliente.</li>
          </ul>
        </div>
      </div>

      <!-- Formulario de selección -->
      <div class="col-md-6">
        <div class="card-custom">
          <div class="mb-3">
            <label class="form-label">Precio del vehículo</label>
            <input type="number" id="precioBase" class="form-control" placeholder="Ej: 10000" value="" />
          </div>

          <div class="mb-3 d-flex align-items-center">
            <label class="form-label me-2">Porcentaje base (%)</label>
            <input type="number" id="porcentajeBase" class="form-control w-25" value="20" />
          </div>

          <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" id="checkConvenio" />
            <label class="form-check-label" for="checkConvenio">Aplicar Convenio</label>
          </div>

          <div class="mb-3">
            <label class="form-label">Descuento por Convenio (%)</label>
            <input type="number" id="descuentoConvenio" class="form-control w-25" value="10" />
          </div>

          <hr />

          <h5>Servicios</h5>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="reparacion" />
            <label class="form-check-label" for="reparacion">Reparación ($45)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="pintura" />
            <label class="form-check-label" for="pintura">Pintura (30% o 5% del porcentaje base)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="modificaciones" />
            <label class="form-check-label" for="modificaciones">Modificaciones (% del porcentaje base)</label>
          </div>

          <button class="btn btn-primary mt-4" onclick="calcularTotal()">Calcular Total</button>
        </div>
      </div>

      <!-- Factura -->
      <div class="col-md-3">
        <div class="ticket" id="ticket">
          <h5>Factura</h5>
          <div id="detalleFactura"></div>
          <button class="btn btn-danger reset-btn w-100" onclick="resetear()">
            <i class="fas fa-trash"></i> Resetear
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function calcularTotal() {
      const precioBase = parseFloat(document.getElementById('precioBase').value) || 0;
      const porcentaje = parseFloat(document.getElementById('porcentajeBase').value) || 0;
      const convenioChecked = document.getElementById('checkConvenio').checked;
      const descuentoConvenio = parseFloat(document.getElementById('descuentoConvenio').value) || 0;
      const tieneReparacion = document.getElementById('reparacion').checked;
      const tienePintura = document.getElementById('pintura').checked;
      const tieneModificaciones = document.getElementById('modificaciones').checked;

      let total = 0;
      let detalles = [];

      if (tieneReparacion) {
        total += 45;
        detalles.push({ desc: 'Reparación', precio: 45 });
      }

      if (tienePintura) {
        let porcentajeUsado = tieneModificaciones ? 5 : 30;
        let pinturaPrecio = Math.ceil(precioBase * (porcentaje / 100) * (porcentajeUsado / 100));
        total += pinturaPrecio;
        detalles.push({ desc: `Pintura (${porcentajeUsado}% del % base)`, precio: pinturaPrecio });
      }

      if (tieneModificaciones) {
        let modPrecio = Math.ceil(precioBase * (porcentaje / 100));
        total += modPrecio;
        detalles.push({ desc: 'Modificaciones', precio: modPrecio });
      }

      let totalConDescuento = total;
      if (convenioChecked) {
        const descuento = Math.ceil(total * (descuentoConvenio / 100));
        totalConDescuento = total - descuento;
        detalles.push({ desc: `Descuento Convenio (${descuentoConvenio}%)`, precio: -descuento });
      }

      const detalleDiv = document.getElementById('detalleFactura');
      detalleDiv.innerHTML = '';
      detalles.forEach(d => {
        const div = document.createElement('div');
        div.className = 'ticket-item';
        div.innerHTML = `<div>${d.desc}</div><div>$${d.precio}</div>`;
        detalleDiv.appendChild(div);
      });

      const totalDiv = document.createElement('div');
      totalDiv.className = 'ticket-item fw-bold border-top pt-2';
      totalDiv.innerHTML = `<div>Total</div><div>$${totalConDescuento}</div>`;
      detalleDiv.appendChild(totalDiv);
    }

    function resetear() {
      document.getElementById('precioBase').value = '';
      document.getElementById('porcentajeBase').value = 20;
      document.getElementById('checkConvenio').checked = false;
      document.getElementById('descuentoConvenio').value = 10;
      document.getElementById('reparacion').checked = false;
      document.getElementById('pintura').checked = false;
      document.getElementById('modificaciones').checked = false;
      document.getElementById('detalleFactura').innerHTML = '';
    }
  </script>
</body>
</html>
